* simple gaussian test case

(Just (normalDistr 4.968167765549936 0.14902957084906035),Just 2714)

     845,709,056 bytes allocated in the heap
      34,022,120 bytes copied during GC
       7,130,304 bytes maximum residency (6 sample(s))
         430,912 bytes maximum slop
               6 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0       798 colls,   798 par    0.184s   0.036s     0.0000s    0.0001s
  Gen  1         6 colls,     5 par    0.016s   0.006s     0.0010s    0.0027s

  Parallel GC work balance: 44.40% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    1.928s  (  2.021s elapsed)
  GC      time    0.200s  (  0.042s elapsed)
  EXIT    time    0.000s  (  0.007s elapsed)
  Total   time    2.128s  (  2.071s elapsed)

  Alloc rate    438,645,775 bytes per MUT second

  Productivity  90.6% of total user, 97.6% of total elapsed


real	0m2.172s
user	0m2.228s
sys	0m0.160s

Compilation finished at Thu Nov 28 12:43:19
* after added counter
(Just (normalDistr 4.968167765549936 0.14902957084906035),Just 2714)
     847,613,872 bytes allocated in the heap
      32,692,880 bytes copied during GC
       6,562,520 bytes maximum residency (6 sample(s))
         429,352 bytes maximum slop
               6 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0       799 colls,   799 par    0.148s   0.038s     0.0000s    0.0003s
  Gen  1         6 colls,     5 par    0.016s   0.007s     0.0011s    0.0026s

  Parallel GC work balance: 42.54% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    2.088s  (  2.060s elapsed)
  GC      time    0.164s  (  0.045s elapsed)
  EXIT    time    0.000s  (  0.005s elapsed)
  Total   time    2.252s  (  2.110s elapsed)

  Alloc rate    405,945,340 bytes per MUT second

  Productivity  92.7% of total user, 97.6% of total elapsed


real	0m2.219s
user	0m2.368s
sys	0m0.156s

Compilation finished at Fri Nov 29 14:04:17
* with global gen and intiialize from seeds
  (Just (normalDistr 4.669105916353021 0.1600423436219402),Just 2259)
     705,954,016 bytes allocated in the heap
      22,946,728 bytes copied during GC
       3,486,800 bytes maximum residency (5 sample(s))
         252,848 bytes maximum slop
               3 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0       665 colls,   665 par    0.128s   0.031s     0.0000s    0.0015s
  Gen  1         5 colls,     4 par    0.008s   0.003s     0.0006s    0.0014s

  Parallel GC work balance: 32.90% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    1.648s  (  1.661s elapsed)
  GC      time    0.136s  (  0.034s elapsed)
  EXIT    time    0.000s  (  0.005s elapsed)
  Total   time    1.784s  (  1.701s elapsed)

  Alloc rate    428,370,155 bytes per MUT second

  Productivity  92.4% of total user, 97.6% of total elapsed


real	0m1.800s
user	0m1.884s
sys	0m0.108s

Compilation finished at Fri Nov 29 14:22:10
* using all cores, 2x (independent) work load
((Just (normalDistr 4.669105916353021 0.1600423436219402),Just 2259),(Just (normalDistr 4.649864615874977 0.15885676362789877),Just 2260))
   1,449,903,552 bytes allocated in the heap
      48,299,496 bytes copied during GC
       3,548,576 bytes maximum residency (9 sample(s))
         263,688 bytes maximum slop
               3 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0      1368 colls,  1368 par    0.308s   0.068s     0.0000s    0.0040s
  Gen  1         9 colls,     8 par    0.028s   0.006s     0.0007s    0.0013s

  Parallel GC work balance: 33.83% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    3.356s  (  3.469s elapsed)
  GC      time    0.336s  (  0.073s elapsed)
  EXIT    time    0.000s  (  0.008s elapsed)
  Total   time    3.692s  (  3.551s elapsed)

  Alloc rate    432,033,239 bytes per MUT second

  Productivity  90.9% of total user, 97.7% of total elapsed


real	0m3.649s
user	0m3.796s
sys	0m0.196s

Compilation finished at Fri Nov 29 14:46:18
* upped precision

(Just (normalDistr 5.061441713223422 6.625001534702141e-2),Just 40800)
  12,733,261,232 bytes allocated in the heap
     464,629,752 bytes copied during GC
      78,047,384 bytes maximum residency (10 sample(s))
       4,499,304 bytes maximum slop
              74 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     12047 colls, 12047 par    3.048s   1.105s     0.0001s    0.0174s
  Gen  1        10 colls,     9 par    0.196s   0.078s     0.0078s    0.0316s

  Parallel GC work balance: 40.60% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time   33.324s  ( 32.880s elapsed)
  GC      time    3.244s  (  1.183s elapsed)
  EXIT    time    0.000s  (  0.007s elapsed)
  Total   time   36.568s  ( 34.070s elapsed)

  Alloc rate    382,104,826 bytes per MUT second

  Productivity  91.1% of total user, 96.5% of total elapsed


real	0m34.174s
user	0m36.692s
sys	0m2.764s
* made likelihood a true join semi lattice

(Just (normalDistr 5.061490797914308 6.625051011601046e-2),Just 40801)
  12,710,666,008 bytes allocated in the heap
     807,047,952 bytes copied during GC
     150,493,248 bytes maximum residency (11 sample(s))
       9,729,984 bytes maximum slop
             143 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     12031 colls, 12031 par    3.448s   0.921s     0.0001s    0.0104s
  Gen  1        11 colls,    10 par    0.352s   0.170s     0.0155s    0.0731s

  Parallel GC work balance: 56.02% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.004s  (  0.001s elapsed)
  MUT     time   69.980s  ( 70.450s elapsed)
  GC      time    3.800s  (  1.092s elapsed)
  EXIT    time    0.000s  (  0.008s elapsed)
  Total   time   73.784s  ( 71.551s elapsed)

  Alloc rate    181,632,838 bytes per MUT second

  Productivity  94.8% of total user, 98.5% of total elapsed


real	1m11.646s
user	1m13.900s
sys	0m2.068s

Compilation finished at Sat Nov 30 02:08:41

* fixed performance slowdown by remove watch on t
watch has a cost
(Just (normalDistr 5.061490797914308 6.625051011601046e-2),Just 40801)
  12,695,325,024 bytes allocated in the heap
     833,865,880 bytes copied during GC
     169,276,368 bytes maximum residency (11 sample(s))
      11,742,256 bytes maximum slop
             161 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     12020 colls, 12020 par    2.952s   0.728s     0.0001s    0.0053s
  Gen  1        11 colls,    10 par    0.376s   0.154s     0.0140s    0.0624s

  Parallel GC work balance: 43.06% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time   29.036s  ( 29.843s elapsed)
  GC      time    3.328s  (  0.882s elapsed)
  EXIT    time    0.000s  (  0.005s elapsed)
  Total   time   32.364s  ( 30.731s elapsed)

  Alloc rate    437,227,063 bytes per MUT second

  Productivity  89.7% of total user, 97.1% of total elapsed


real	0m30.832s
user	0m32.468s
sys	0m1.844s

Compilation finished at Sat Nov 30 02:11:11
* using reparameterizaiton gradients
(Just (normalDistr 5.063620319769442 3.165631307037202e-2),Just (T 1878),Just (M [3432.2971915904577,15164.883626402921]))
  51,271,271,168 bytes allocated in the heap
     289,912,840 bytes copied during GC
       9,361,208 bytes maximum residency (31 sample(s))
         514,248 bytes maximum slop
               8 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     49497 colls, 49497 par    4.760s   1.235s     0.0000s    0.0106s
  Gen  1        31 colls,    30 par    0.084s   0.033s     0.0011s    0.0031s

  Parallel GC work balance: 27.06% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time   12.756s  ( 13.361s elapsed)
  GC      time    4.844s  (  1.267s elapsed)
  EXIT    time    0.000s  (  0.001s elapsed)
  Total   time   17.600s  ( 14.630s elapsed)

  Alloc rate    4,019,384,694 bytes per MUT second

  Productivity  72.5% of total user, 91.3% of total elapsed


real	0m14.735s
user	0m17.716s
sys	0m2.580s

Compilation finished at Sat Nov 30 21:40:50
* using score gradient (rao-blackwellization)
(Just (normalDistr 5.076149364148417 0.15815417462641682),Just (T 11961),Just (M [8.69901910956249e8,7.676328370936261e10]))
   1,293,426,032 bytes allocated in the heap
     261,677,872 bytes copied during GC
      58,686,616 bytes maximum residency (9 sample(s))
       2,380,648 bytes maximum slop
              55 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0      1177 colls,  1177 par    0.632s   0.175s     0.0001s    0.0128s
  Gen  1         9 colls,     8 par    0.128s   0.051s     0.0057s    0.0210s

  Parallel GC work balance: 48.15% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    9.288s  (  9.581s elapsed)
  GC      time    0.760s  (  0.226s elapsed)
  EXIT    time    0.000s  (  0.003s elapsed)
  Total   time   10.048s  (  9.811s elapsed)

  Alloc rate    139,257,755 bytes per MUT second

  Productivity  92.4% of total user, 97.7% of total elapsed


real	0m9.912s
user	0m10.176s
sys	0m0.504s

Compilation finished at Sat Nov 30 21:42:54
* simpler
(normalDistr 5.061441713223423 6.625001534702159e-2,40800)
  12,490,907,016 bytes allocated in the heap
     453,528,760 bytes copied during GC
      83,860,776 bytes maximum residency (10 sample(s))
       4,702,936 bytes maximum slop
              79 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     11854 colls, 11854 par    2.276s   0.590s     0.0000s    0.0103s
  Gen  1        10 colls,     9 par    0.204s   0.075s     0.0075s    0.0307s

  Parallel GC work balance: 39.26% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.002s elapsed)
  MUT     time   39.172s  ( 39.567s elapsed)
  GC      time    2.480s  (  0.665s elapsed)
  EXIT    time    0.000s  (  0.007s elapsed)
  Total   time   41.652s  ( 40.241s elapsed)

  Alloc rate    318,873,353 bytes per MUT second

  Productivity  94.0% of total user, 98.3% of total elapsed


real	0m40.341s
user	0m41.756s
sys	0m1.460s

Compilation finished at Sun Dec  1 01:43:34
* maybe naive greedy algo appears to work (no exponetial blow up of thunks)

(normalDistr 5.071612705591072 5.349675807683909e-2,100000,5.064943538470939)
2,192,294,233,192 bytes allocated in the heap
  15,339,162,768 bytes copied during GC
     477,936,768 bytes maximum residency (60 sample(s))
      32,510,848 bytes maximum slop
             455 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     2104520 colls, 2104520 par   282.792s  88.102s     0.0000s    0.0448s
  Gen  1        60 colls,    59 par    7.648s   2.824s     0.0471s    0.9389s

  Parallel GC work balance: 29.71% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time  818.824s  (801.149s elapsed)
  GC      time  290.440s  ( 90.926s elapsed)
  EXIT    time    0.000s  (  0.004s elapsed)
  Total   time  1109.264s  (892.080s elapsed)

  Alloc rate    2,677,369,292 bytes per MUT second

  Productivity  73.8% of total user, 89.8% of total elapsed


real	14m52.187s
user	18m29.384s
sys	3m19.036s

Compilation finished at Sun Dec  1 10:10:54
* benchmark of ad before doing transform everywhere

(normalDistr 5.063682480265621 3.1619719070280466e-2,4664,5.064943538470939)
 104,851,688,152 bytes allocated in the heap
     655,951,016 bytes copied during GC
      23,826,056 bytes maximum residency (37 sample(s))
       1,552,760 bytes maximum slop
              22 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     100656 colls, 100656 par   10.400s   2.488s     0.0000s    0.0092s
  Gen  1        37 colls,    36 par    0.228s   0.080s     0.0022s    0.0084s

  Parallel GC work balance: 30.43% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.002s elapsed)
  MUT     time   29.336s  ( 31.021s elapsed)
  GC      time   10.628s  (  2.568s elapsed)
  EXIT    time    0.004s  (  0.010s elapsed)
  Total   time   39.968s  ( 33.602s elapsed)

  Alloc rate    3,574,164,444 bytes per MUT second

  Productivity  73.4% of total user, 92.3% of total elapsed


real	0m34.047s
user	0m40.448s
sys	0m6.168s

Compilation finished at Sun Dec  1 12:19:22
* after making generic and adding rho
(normalDistr 5.063682480265621 3.1619719070280466e-2,4664,5.064943538470939)
 104,841,360,576 bytes allocated in the heap
     608,331,480 bytes copied during GC
      12,310,024 bytes maximum residency (52 sample(s))
         743,928 bytes maximum slop
              11 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     100629 colls, 100629 par   13.732s   4.721s     0.0000s    0.0333s
  Gen  1        52 colls,    51 par    0.256s   0.093s     0.0018s    0.0175s

  Parallel GC work balance: 25.89% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time   36.332s  ( 35.598s elapsed)
  GC      time   13.988s  (  4.814s elapsed)
  EXIT    time    0.000s  (  0.008s elapsed)
  Total   time   50.320s  ( 40.421s elapsed)

  Alloc rate    2,885,647,929 bytes per MUT second

  Productivity  72.2% of total user, 88.1% of total elapsed


real	0m40.520s
user	0m50.444s
sys	0m10.248s

Compilation finished at Sun Dec  1 13:44:16
* after adding type signatures and propQAD
  (normalDistr 5.063682480265621 3.1619719070280466e-2,4664,5.064943538470939)
 104,841,360,256 bytes allocated in the heap
     608,988,576 bytes copied during GC
      12,409,032 bytes maximum residency (52 sample(s))
         694,072 bytes maximum slop
              11 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     100629 colls, 100629 par   22.344s  10.678s     0.0001s    0.0276s
  Gen  1        52 colls,    51 par    0.244s   0.115s     0.0022s    0.0181s

  Parallel GC work balance: 24.52% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.004s  (  0.001s elapsed)
  MUT     time   49.216s  ( 43.504s elapsed)
  GC      time   22.588s  ( 10.793s elapsed)
  EXIT    time    0.004s  (  0.003s elapsed)
  Total   time   71.812s  ( 54.300s elapsed)

  Alloc rate    2,130,229,198 bytes per MUT second

  Productivity  68.5% of total user, 80.1% of total elapsed


real	0m54.416s
user	1m11.928s
sys	0m21.448s

Compilation finished at Sun Dec  1 14:32:59
* refactored to do correct updating based ong radient

(normalDistr 5.063682480265621 3.1619719070280466e-2,4664,5.064943538470939)
 104,842,605,848 bytes allocated in the heap
     535,700,696 bytes copied during GC
       1,290,952 bytes maximum residency (196 sample(s))
         121,688 bytes maximum slop
               1 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     100487 colls, 100487 par   10.024s   2.268s     0.0000s    0.0135s
  Gen  1       196 colls,   195 par    0.164s   0.058s     0.0003s    0.0101s

  Parallel GC work balance: 18.69% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time   28.748s  ( 30.726s elapsed)
  GC      time   10.188s  (  2.325s elapsed)
  EXIT    time    0.004s  (  0.009s elapsed)
  Total   time   38.940s  ( 33.061s elapsed)

  Alloc rate    3,646,953,034 bytes per MUT second

  Productivity  73.8% of total user, 92.9% of total elapsed


real	0m33.171s
user	0m39.076s
sys	0m5.692s

Compilation finished at Mon Dec  2 12:35:43
* after making obs a sample-able propagator

(normalDistr 5.049435636395849 9.98830321687391e-2,5574,5.064943538470939,1,1000)
  12,986,638,376 bytes allocated in the heap
     348,854,616 bytes copied during GC
       1,532,024 bytes maximum residency (145 sample(s))
         120,872 bytes maximum slop
               1 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     12343 colls, 12343 par    1.856s   0.549s     0.0000s    0.0074s
  Gen  1       145 colls,   144 par    0.128s   0.040s     0.0003s    0.0007s

  Parallel GC work balance: 24.45% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    3.544s  (  3.955s elapsed)
  GC      time    1.984s  (  0.589s elapsed)
  EXIT    time    0.000s  (  0.005s elapsed)
  Total   time    5.528s  (  4.550s elapsed)

  Alloc rate    3,664,401,347 bytes per MUT second

  Productivity  64.1% of total user, 86.9% of total elapsed


real	0m4.650s
user	0m5.632s
sys	0m1.420s

Compilation finished at Mon Dec  2 14:52:15
* after making sum type to allow for vector random variables (categoricals)
(normalDistr 5.049435636395849 9.98830321687391e-2,5574,5.064943538470939,1)
  13,000,015,488 bytes allocated in the heap
     383,824,616 bytes copied during GC
       1,537,040 bytes maximum residency (158 sample(s))
         126,760 bytes maximum slop
               1 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     12347 colls, 12347 par    2.172s   0.594s     0.0000s    0.0050s
  Gen  1       158 colls,   157 par    0.124s   0.044s     0.0003s    0.0007s

  Parallel GC work balance: 24.16% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    3.596s  (  4.108s elapsed)
  GC      time    2.296s  (  0.638s elapsed)
  EXIT    time    0.000s  (  0.003s elapsed)
  Total   time    5.892s  (  4.750s elapsed)

  Alloc rate    3,615,132,226 bytes per MUT second

  Productivity  61.0% of total user, 86.5% of total elapsed


real	0m4.847s
user	0m6.000s
sys	0m1.456s

Compilation finished at Mon Dec  2 22:53:50
* replaced sum type with multi param typeclasses
(normalDistr 5.049435636395849 9.98830321687391e-2,5574,5.064943538470939,1)
  12,986,638,032 bytes allocated in the heap
     348,638,560 bytes copied during GC
       1,519,816 bytes maximum residency (145 sample(s))
         116,776 bytes maximum slop
               1 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     12343 colls, 12343 par    2.016s   0.558s     0.0000s    0.0174s
  Gen  1       145 colls,   144 par    0.164s   0.045s     0.0003s    0.0042s

  Parallel GC work balance: 24.73% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    3.492s  (  3.963s elapsed)
  GC      time    2.180s  (  0.603s elapsed)
  EXIT    time    0.000s  (  0.004s elapsed)
  Total   time    5.672s  (  4.571s elapsed)

  Alloc rate    3,718,968,508 bytes per MUT second

  Productivity  61.6% of total user, 86.7% of total elapsed


real	0m4.667s
user	0m5.776s
sys	0m1.364s

Compilation finished at Tue Dec  3 12:17:49
* after making normalDistr a vector

(ND [5.062354829939685,9.982268219558518e-2],2301,5.062808516091027,1)
   6,872,214,368 bytes allocated in the heap
     160,388,600 bytes copied during GC
         857,992 bytes maximum residency (87 sample(s))
         127,600 bytes maximum slop
               0 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0      6569 colls,  6569 par    1.092s   0.276s     0.0000s    0.0041s
  Gen  1        87 colls,    86 par    0.056s   0.021s     0.0002s    0.0045s

  Parallel GC work balance: 21.65% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    1.868s  (  2.132s elapsed)
  GC      time    1.148s  (  0.297s elapsed)
  EXIT    time    0.004s  (  0.010s elapsed)
  Total   time    3.020s  (  2.441s elapsed)

  Alloc rate    3,678,915,614 bytes per MUT second

  Productivity  61.9% of total user, 87.4% of total elapsed


real	0m2.578s
user	0m3.164s
sys	0m0.696s

Compilation finished at Tue Dec  3 15:49:49
* switched to vector interface

(ND [5.0583721972032265,9.977285900179446e-2],7050,5.062808516091027,1)
  21,080,553,984 bytes allocated in the heap
     546,280,472 bytes copied during GC
       2,395,448 bytes maximum residency (176 sample(s))
         105,528 bytes maximum slop
               2 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     20154 colls, 20154 par    2.896s   0.855s     0.0000s    0.0061s
  Gen  1       176 colls,   175 par    0.216s   0.065s     0.0004s    0.0043s

  Parallel GC work balance: 26.77% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.004s  (  0.001s elapsed)
  MUT     time    4.244s  (  5.105s elapsed)
  GC      time    3.112s  (  0.919s elapsed)
  EXIT    time    0.004s  (  0.005s elapsed)
  Total   time    7.364s  (  6.031s elapsed)

  Alloc rate    4,967,142,786 bytes per MUT second

  Productivity  57.6% of total user, 84.6% of total elapsed


real	0m6.171s
user	0m7.500s
sys	0m2.028s

Compilation finished at Tue Dec  3 17:18:04
* after making differentiable floating rather than double

(ND [5.0583721972032265,9.977285900179446e-2],7050,5.062808516091027,1)
  21,097,564,864 bytes allocated in the heap
     562,266,968 bytes copied during GC
       2,387,416 bytes maximum residency (184 sample(s))
         106,024 bytes maximum slop
               2 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     20302 colls, 20302 par    3.776s   1.496s     0.0001s    0.0209s
  Gen  1       184 colls,   183 par    0.260s   0.106s     0.0006s    0.0107s

  Parallel GC work balance: 26.18% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    5.656s  (  5.382s elapsed)
  GC      time    4.036s  (  1.603s elapsed)
  EXIT    time    0.000s  (  0.005s elapsed)
  Total   time    9.692s  (  6.991s elapsed)

  Alloc rate    3,730,121,086 bytes per MUT second

  Productivity  58.4% of total user, 77.0% of total elapsed


real	0m7.095s
user	0m9.804s
sys	0m3.104s

Compilation finished at Wed Dec  4 11:21:29
* using autodiff instead of deterministic f for gradtransform
  (ND [5.0583721972032265,9.977285900179446e-2],7050,5.062808516091027,1)
  24,024,945,104 bytes allocated in the heap
   1,075,198,272 bytes copied during GC
       2,409,528 bytes maximum residency (331 sample(s))
         101,976 bytes maximum slop
               2 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     22921 colls, 22921 par    4.784s   1.543s     0.0001s    0.0078s
  Gen  1       331 colls,   330 par    0.368s   0.128s     0.0004s    0.0059s

  Parallel GC work balance: 26.04% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    5.256s  (  6.000s elapsed)
  GC      time    5.152s  (  1.671s elapsed)
  EXIT    time    0.000s  (  0.009s elapsed)
  Total   time   10.408s  (  7.681s elapsed)

  Alloc rate    4,570,956,070 bytes per MUT second

  Productivity  50.5% of total user, 78.1% of total elapsed


real	0m7.781s
user	0m10.516s
sys	0m3.424s

Compilation finished at Wed Dec  4 11:25:57
* added more flexible and direct programming
  (ND [5.0583721972032265,9.977285900179446e-2],7050,5.062808516091027,1)
  21,080,294,480 bytes allocated in the heap
     551,244,808 bytes copied during GC
       2,448,352 bytes maximum residency (177 sample(s))
         144,672 bytes maximum slop
               2 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     20190 colls, 20190 par    3.012s   0.895s     0.0000s    0.0146s
  Gen  1       177 colls,   176 par    0.224s   0.066s     0.0004s    0.0025s

  Parallel GC work balance: 26.17% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    4.808s  (  5.402s elapsed)
  GC      time    3.236s  (  0.961s elapsed)
  EXIT    time    0.000s  (  0.007s elapsed)
  Total   time    8.044s  (  6.370s elapsed)

  Alloc rate    4,384,420,648 bytes per MUT second

  Productivity  59.8% of total user, 84.8% of total elapsed


real	0m6.469s
user	0m8.128s
sys	0m1.884s

Compilation finished at Wed Dec  4 13:07:40
* mixed membership, nsamp=10, eta=0.01, random init of qs (but std=2.0), running till convergence

(Diri [0.6499292704012393,0.1209336857571866],945442,[945435,945441],[ND [-1.1226830318579168,2.7940558851405877],ND [1.256596275602703,3.742514769946408]])
1,231,314,121,848 bytes allocated in the heap
  41,531,572,176 bytes copied during GC
     310,235,368 bytes maximum residency (208 sample(s))
       5,672,640 bytes maximum slop
             295 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     1186065 colls, 1186065 par   480.244s  193.568s     0.0002s    0.0605s
  Gen  1       208 colls,   207 par   12.936s   4.452s     0.0214s    0.1873s

  Parallel GC work balance: 17.69% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time  1196.952s  (1142.080s elapsed)
  GC      time  493.180s  (198.021s elapsed)
  EXIT    time    0.000s  (  0.009s elapsed)
  Total   time  1690.132s  (1340.111s elapsed)

  Alloc rate    1,028,708,019 bytes per MUT second

  Productivity  70.8% of total user, 85.2% of total elapsed


real	22m20.218s
user	28m10.260s
sys	6m30.076s

Compilation finished at Wed Dec  4 23:25:03
* as above, but with std = 1.0
(Diri [0.6749616302045355,0.1186623548552856],416851,[416852,416852],[ND [-1.5831682269738274,2.6096311200907913],ND [1.9185913210413548,3.408863064991701]])
 542,898,130,848 bytes allocated in the heap
  18,242,140,792 bytes copied during GC
     135,216,352 bytes maximum residency (182 sample(s))
       2,503,456 bytes maximum slop
             128 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     522859 colls, 522859 par   139.260s  41.524s     0.0001s    0.0287s
  Gen  1       182 colls,   181 par    5.560s   1.616s     0.0089s    0.0475s

  Parallel GC work balance: 19.12% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time  333.240s  (362.262s elapsed)
  GC      time  144.820s  ( 43.140s elapsed)
  EXIT    time    0.000s  (  0.008s elapsed)
  Total   time  478.060s  (405.411s elapsed)

  Alloc rate    1,629,150,554 bytes per MUT second

  Productivity  69.7% of total user, 89.4% of total elapsed


real	6m45.514s
user	7m58.176s
sys	1m35.724s

Compilation finished at Wed Dec  4 23:49:46
* after switchig from content to With
(Diri [0.37407687886113977,0.2500654535833052],1000,[1000,1000],[ND [-4.217702088697038,1.2853765856660118],ND [3.9712485472773036,1.2746761783710816]])

real	0m1.068s
user	0m1.256s
sys	0m0.220s

Compilation finished at Thu Dec  5 13:02:29
* after swtiching to local delta
(Diri [0.37407687886113977,0.2500654535833052],1000,[1000,1000],[ND [-4.217702088697038,1.2853765856660118],ND [3.9712485472773036,1.2746761783710816]])
   1,302,653,176 bytes allocated in the heap
      38,036,536 bytes copied during GC
         489,184 bytes maximum residency (14 sample(s))
          86,056 bytes maximum slop
               0 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0      1241 colls,  1241 par    0.300s   0.079s     0.0001s    0.0004s
  Gen  1        14 colls,    13 par    0.008s   0.003s     0.0002s    0.0006s

  Parallel GC work balance: 8.25% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    0.712s  (  0.787s elapsed)
  GC      time    0.308s  (  0.082s elapsed)
  EXIT    time    0.000s  (  0.011s elapsed)
  Total   time    1.020s  (  0.880s elapsed)

  Alloc rate    1,829,569,067 bytes per MUT second

  Productivity  69.8% of total user, 89.4% of total elapsed


real	0m0.983s
user	0m1.136s
sys	0m0.188s

Compilation finished at Thu Dec  5 13:54:20

* using just score gradient
  (Diri [0.4020449592942055,0.23401379147894777],1000,[1000,1000],[ND [-4.210459833170123,1.257265053132033],ND [3.9590634148308865,1.2538638655005245]])

real	0m0.247s
user	0m0.264s
sys	0m0.048s

Compilation finished at Thu Dec  5 13:11:25
* using score gradient with larger n

(Diri [0.6960106731216394,0.11658897951492068],100000,[100000,100000],[ND [-2.065983329828528,2.164855691024952],ND [2.453332112544073,2.5372947343055947]])
   9,261,140,536 bytes allocated in the heap
     177,820,576 bytes copied during GC
      29,595,072 bytes maximum residency (8 sample(s))
         440,896 bytes maximum slop
              28 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0      8933 colls,  8933 par    1.492s   0.308s     0.0000s    0.0040s
  Gen  1         8 colls,     7 par    0.064s   0.026s     0.0033s    0.0115s

  Parallel GC work balance: 34.28% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    6.564s  (  7.015s elapsed)
  GC      time    1.556s  (  0.334s elapsed)
  EXIT    time    0.000s  (  0.001s elapsed)
  Total   time    8.120s  (  7.351s elapsed)

  Alloc rate    1,410,898,923 bytes per MUT second

  Productivity  80.8% of total user, 95.4% of total elapsed


real	0m7.460s
user	0m8.232s
sys	0m1.008s

Compilation finished at Thu Dec  5 13:13:01
* using score gradient with  n = 1000000
  (Diri [0.658408591841756,0.12299070726360173],945376,[945370,945372],[ND [-0.698741273194455,2.6452611378976947],ND [0.3122453262040584,3.52857269568998]])
  87,549,814,032 bytes allocated in the heap
   1,578,768,384 bytes copied during GC
     219,112,192 bytes maximum residency (11 sample(s))
       3,398,912 bytes maximum slop
             208 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     84513 colls, 84513 par   21.964s   9.228s     0.0001s    0.0259s
  Gen  1        11 colls,    10 par    0.552s   0.319s     0.0290s    0.1242s

  Parallel GC work balance: 29.61% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.004s  (  0.002s elapsed)
  MUT     time   93.624s  ( 90.118s elapsed)
  GC      time   22.516s  (  9.546s elapsed)
  EXIT    time    0.000s  (  0.005s elapsed)
  Total   time  116.144s  ( 99.671s elapsed)

  Alloc rate    935,121,486 bytes per MUT second

  Productivity  80.6% of total user, 90.4% of total elapsed


real	1m39.769s
user	1m56.240s
sys	0m20.200s

Compilation finished at Thu Dec  5 13:15:54
* using reparam gradient with n = 1000000
(Diri [0.6749616302045355,0.1186623548552856],416851,[416852,416852],[ND [-1.5831682269738274,2.6096311200907913],ND [1.9185913210413548,3.408863064991701]])
 542,873,808,840 bytes allocated in the heap
  18,324,337,264 bytes copied during GC
     140,147,808 bytes maximum residency (180 sample(s))
       1,373,088 bytes maximum slop
             133 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     522851 colls, 522851 par   182.172s  72.602s     0.0001s    0.0390s
  Gen  1       180 colls,   179 par    5.900s   2.098s     0.0117s    0.1649s

  Parallel GC work balance: 17.72% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time  474.652s  (460.455s elapsed)
  GC      time  188.072s  ( 74.701s elapsed)
  EXIT    time    0.000s  (  0.004s elapsed)
  Total   time  662.724s  (535.160s elapsed)

  Alloc rate    1,143,730,161 bytes per MUT second

  Productivity  71.6% of total user, 86.0% of total elapsed


real	8m55.284s
user	11m2.856s
sys	2m25.756s

Compilation finished at Thu Dec  5 13:27:52
* multiple watches

 146,860,540,672 bytes allocated in the heap
  10,509,152,360 bytes copied during GC
   4,119,123,528 bytes maximum residency (18 sample(s))
      12,310,968 bytes maximum slop
            3928 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     141533 colls, 57752 par   24.004s  10.848s     0.0001s    0.0123s
  Gen  1        18 colls,    13 par   41.972s  38.683s     2.1491s    9.3403s

  Parallel GC work balance: 53.78% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time   80.016s  ( 85.300s elapsed)
  GC      time   65.976s  ( 49.531s elapsed)
  EXIT    time    0.000s  (  0.009s elapsed)
  Total   time  145.992s  (134.841s elapsed)

  Alloc rate    1,835,389,680 bytes per MUT second

  Productivity  54.8% of total user, 63.3% of total elapsed


Compilation interrupt at Thu Dec  5 13:48:42
* BBVI cavi (delta = 0.001)

(Diri [0.4222317567618725,0.13358056388368733],34,[823,255],[ND [-2.8278739750278885,2.507151036808321],ND [3.358372261568756,2.084664901585792]])
   2,912,019,496 bytes allocated in the heap
      25,943,096 bytes copied during GC
         332,160 bytes maximum residency (7 sample(s))
          94,816 bytes maximum slop
               0 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0      2807 colls,  2807 par    0.428s   0.087s     0.0000s    0.0041s
  Gen  1         7 colls,     6 par    0.004s   0.002s     0.0002s    0.0006s

  Parallel GC work balance: 3.64% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    1.772s  (  1.798s elapsed)
  GC      time    0.432s  (  0.089s elapsed)
  EXIT    time    0.004s  (  0.013s elapsed)
  Total   time    2.208s  (  1.901s elapsed)

  Alloc rate    1,643,351,860 bytes per MUT second

  Productivity  80.3% of total user, 94.6% of total elapsed


real	0m1.997s
user	0m2.316s
sys	0m0.176s

Compilation finished at Thu Dec  5 14:32:38
* bbvi cavi (delta = 0.0000001)
(Diri [0.47343967031588613,0.2325503243055342],27,[1000000,196516],[ND [-0.43114203431859255,3.0716936627972076],ND [-0.25409021267803594,3.4490861429061166]])
2,652,145,976,056 bytes allocated in the heap
  26,623,967,592 bytes copied during GC
     403,097,104 bytes maximum residency (90 sample(s))
      46,672,368 bytes maximum slop
             384 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     2561002 colls, 2561002 par   392.236s  94.141s     0.0000s    0.0344s
  Gen  1        90 colls,    89 par    8.004s   2.727s     0.0303s    0.2638s

  Parallel GC work balance: 13.47% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time  1534.512s  (1629.760s elapsed)
  GC      time  400.240s  ( 96.868s elapsed)
  EXIT    time    0.000s  (  0.002s elapsed)
  Total   time  1934.752s  (1726.630s elapsed)

  Alloc rate    1,728,331,857 bytes per MUT second

  Productivity  79.3% of total user, 94.4% of total elapsed


real	28m46.733s
user	32m14.868s
sys	3m57.048s

Compilation finished at Thu Dec  5 15:05:37
* after making node a part of prop node sum type, and adding vectorized merge
(Diri [0.6209110818935473,0.12297069403986714],1000,[1000,1000],[ND [-2.6816947165637113,2.400464478991991],ND [2.836622019413764,2.7073122713136746]])
   1,303,129,680 bytes allocated in the heap
      38,524,912 bytes copied during GC
         490,392 bytes maximum residency (15 sample(s))
          98,672 bytes maximum slop
               0 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0      1240 colls,  1240 par    0.304s   0.079s     0.0001s    0.0003s
  Gen  1        15 colls,    14 par    0.024s   0.012s     0.0008s    0.0097s

  Parallel GC work balance: 8.41% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    0.760s  (  0.817s elapsed)
  GC      time    0.328s  (  0.091s elapsed)
  EXIT    time    0.000s  (  0.011s elapsed)
  Total   time    1.088s  (  0.921s elapsed)

  Alloc rate    1,714,644,315 bytes per MUT second

  Productivity  69.9% of total user, 88.7% of total elapsed


real	0m1.025s
user	0m1.200s
sys	0m0.212s

Compilation finished at Thu Dec  5 15:42:30

* testing vectorized merge
(Diri [0.3711075984940394,0.5077348998199782],2,[1000,1000],[ND [-2.821586689418105,2.5522227169671625],ND [2.709113755959471,2.7104526648635305]])
   2,493,919,440 bytes allocated in the heap
      23,632,704 bytes copied during GC
         744,624 bytes maximum residency (6 sample(s))
         107,376 bytes maximum slop
               0 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0      2405 colls,  2405 par    0.388s   0.084s     0.0000s    0.0037s
  Gen  1         6 colls,     5 par    0.004s   0.002s     0.0003s    0.0003s

  Parallel GC work balance: 8.32% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    1.432s  (  1.572s elapsed)
  GC      time    0.392s  (  0.085s elapsed)
  EXIT    time    0.000s  (  0.003s elapsed)
  Total   time    1.824s  (  1.661s elapsed)

  Alloc rate    1,741,563,854 bytes per MUT second

  Productivity  78.5% of total user, 94.7% of total elapsed


real	0m1.759s
user	0m1.924s
sys	0m0.332s

Compilation finished at Thu Dec  5 15:49:46

* same as above, but only calculating theta or beta gradients as needed (testing lazyness ofs tate monad)

(Diri [0.3711075984940394,0.5077348998199782],2,[1000,1000],[ND [-2.821586689418105,2.5522227169671625],ND [2.709113755959471,2.7104526648635305]])
   2,465,090,640 bytes allocated in the heap
      23,517,984 bytes copied during GC
         766,920 bytes maximum residency (6 sample(s))
          98,464 bytes maximum slop
               0 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0      2375 colls,  2375 par    0.356s   0.098s     0.0000s    0.0092s
  Gen  1         6 colls,     5 par    0.000s   0.002s     0.0003s    0.0005s

  Parallel GC work balance: 7.69% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    1.532s  (  1.606s elapsed)
  GC      time    0.356s  (  0.100s elapsed)
  EXIT    time    0.000s  (  0.004s elapsed)
  Total   time    1.888s  (  1.711s elapsed)

  Alloc rate    1,609,066,997 bytes per MUT second

  Productivity  81.1% of total user, 93.8% of total elapsed


real	0m1.818s
user	0m2.008s
sys	0m0.328s

Compilation finished at Thu Dec  5 15:59:21
* fit dirichlet
(Diri [6.853877107667254,13.033755540631176],100000)
  34,161,171,472 bytes allocated in the heap
   1,166,054,760 bytes copied during GC
      31,182,952 bytes maximum residency (8 sample(s))
         831,384 bytes maximum slop
              29 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     32452 colls, 32452 par    8.392s   2.102s     0.0001s    0.0067s
  Gen  1         8 colls,     7 par    0.068s   0.030s     0.0038s    0.0129s

  Parallel GC work balance: 4.72% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.002s elapsed)
  MUT     time  346.184s  (348.894s elapsed)
  GC      time    8.460s  (  2.132s elapsed)
  EXIT    time    0.000s  (  0.003s elapsed)
  Total   time  354.644s  (351.031s elapsed)

  Alloc rate    98,679,232 bytes per MUT second

  Productivity  97.6% of total user, 99.4% of total elapsed


real	5m51.131s
user	5m54.748s
sys	0m4.876s

Compilation finished at Thu Dec  5 22:14:49
* fit dirischlet long sample
(Diri [11.059145392781117,21.319850410163703],1000000)
 332,993,547,184 bytes allocated in the heap
  11,153,430,344 bytes copied during GC
     234,804,664 bytes maximum residency (11 sample(s))
       7,948,872 bytes maximum slop
             223 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     316422 colls, 316422 par   86.604s  21.328s     0.0001s    0.0209s
  Gen  1        11 colls,    10 par    0.668s   0.261s     0.0238s    0.1195s

  Parallel GC work balance: 3.69% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time  3454.252s  (3484.223s elapsed)
  GC      time   87.272s  ( 21.590s elapsed)
  EXIT    time    0.000s  (  0.008s elapsed)
  Total   time  3541.524s  (3505.821s elapsed)

  Alloc rate    96,401,057 bytes per MUT second

  Productivity  97.5% of total user, 99.4% of total elapsed


real	58m25.919s
user	59m1.608s
sys	0m53.184s

Compilation finished at Fri Dec  6 19:34:38

* mixed, only diri, nsamp = 10 nobs = 100
(Diri [1.1577004510445816,2.113892617739873],2,[1,1],[ND [5.0,0.1],ND [-5.0,0.1]])
  37,620,317,992 bytes allocated in the heap
     398,702,856 bytes copied during GC
      31,939,040 bytes maximum residency (8 sample(s))
         955,936 bytes maximum slop
              30 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     36193 colls, 36193 par    9.256s   3.540s     0.0001s    0.0220s
  Gen  1         8 colls,     7 par    0.120s   0.042s     0.0052s    0.0149s

  Parallel GC work balance: 13.45% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time   46.784s  ( 45.689s elapsed)
  GC      time    9.376s  (  3.582s elapsed)
  EXIT    time    0.000s  (  0.009s elapsed)
  Total   time   56.160s  ( 49.281s elapsed)

  Alloc rate    804,127,864 bytes per MUT second

  Productivity  83.3% of total user, 92.7% of total elapsed


real	0m49.386s
user	0m56.264s
sys	0m7.784s

Compilation finished at Sat Dec  7 14:58:45
* mixed, nsamp = 10, n obs= 10
(Diri [1.3299327625083133,2.6024919050124775],2,[1,1],[ND [5.0,0.1],ND [-5.0,0.1]])
  72,295,903,976 bytes allocated in the heap
   1,441,120,928 bytes copied during GC
     214,743,600 bytes maximum residency (11 sample(s))
       7,079,376 bytes maximum slop
             204 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     69382 colls, 69382 par   15.564s   4.842s     0.0001s    0.0319s
  Gen  1        11 colls,    10 par    0.700s   0.346s     0.0315s    0.1467s

  Parallel GC work balance: 24.08% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time   72.328s  ( 70.948s elapsed)
  GC      time   16.264s  (  5.188s elapsed)
  EXIT    time    0.000s  (  0.004s elapsed)
  Total   time   88.592s  ( 76.140s elapsed)

  Alloc rate    999,556,243 bytes per MUT second

  Productivity  81.6% of total user, 93.2% of total elapsed


real	1m16.257s
user	1m28.728s
sys	0m11.508s

Compilation finished at Sat Dec  7 15:04:57
* mixed, fitting both at once, reparam, nObs=100
  (Diri [1.0086569635973237,1.8427299385215417],1000,[1000,1000],[ND [4.907418360802153,0.17344881531727663],ND [-4.970463524796255,0.11917355571557574]])
  12,812,693,096 bytes allocated in the heap
   1,772,069,232 bytes copied during GC
         840,136 bytes maximum residency (1016 sample(s))
         230,016 bytes maximum slop
               0 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0     11249 colls, 11249 par    8.568s   3.721s     0.0003s    0.0253s
  Gen  1      1016 colls,  1015 par    1.044s   0.518s     0.0005s    0.0174s

  Parallel GC work balance: 19.75% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time   11.676s  ( 11.674s elapsed)
  GC      time    9.612s  (  4.239s elapsed)
  EXIT    time    0.000s  (  0.006s elapsed)
  Total   time   21.288s  ( 15.920s elapsed)

  Alloc rate    1,097,352,954 bytes per MUT second

  Productivity  54.8% of total user, 73.3% of total elapsed


real	0m16.020s
user	0m21.392s
sys	0m6.688s

Compilation finished at Sat Dec  7 15:20:24
* as above, but nObs = 10
(Diri [0.9169142505889198,1.8952847833345803],1000,[1000,1000],[ND [4.260480097767227,0.4896550397756462],ND [-4.5904360185218245,0.3691979579239628]])
   1,356,290,576 bytes allocated in the heap
      41,624,456 bytes copied during GC
         538,584 bytes maximum residency (17 sample(s))
         206,984 bytes maximum slop
               0 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0      1290 colls,  1290 par    0.836s   0.425s     0.0003s    0.0349s
  Gen  1        17 colls,    16 par    0.000s   0.004s     0.0002s    0.0004s

  Parallel GC work balance: 9.23% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    1.548s  (  1.426s elapsed)
  GC      time    0.836s  (  0.429s elapsed)
  EXIT    time    0.000s  (  0.005s elapsed)
  Total   time    2.384s  (  1.860s elapsed)

  Alloc rate    876,156,702 bytes per MUT second

  Productivity  64.9% of total user, 76.6% of total elapsed


real	0m1.997s
user	0m2.524s
sys	0m0.684s

Compilation finished at Sat Dec  7 15:23:16
* mixed, fitting both at once, score, nObs=100
(Diri [0.9735863063935011,1.751558406490411],1000,[1000,1000],[ND [4.157958040015821,0.6654694515041761],ND [-4.642790860179611,0.34848542966393536]])
     407,397,584 bytes allocated in the heap
       4,502,008 bytes copied during GC
         147,864 bytes maximum residency (2 sample(s))
         196,200 bytes maximum slop
               0 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0       390 colls,   390 par    0.048s   0.020s     0.0001s    0.0020s
  Gen  1         2 colls,     1 par    0.000s   0.001s     0.0004s    0.0007s

  Parallel GC work balance: 2.26% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    0.464s  (  0.434s elapsed)
  GC      time    0.048s  (  0.020s elapsed)
  EXIT    time    0.000s  (  0.005s elapsed)
  Total   time    0.512s  (  0.460s elapsed)

  Alloc rate    878,012,034 bytes per MUT second

  Productivity  90.6% of total user, 94.3% of total elapsed


real	0m0.564s
user	0m0.644s
sys	0m0.088s

Compilation finished at Sat Dec  7 15:26:07
* as above, but maxstep=20000
(Diri [1.7596579351373485,3.280324879448113],20000,[20000,20000],[ND [4.92013663421398,0.39977027116262714],ND [-4.971513243977412,0.21710460430720604]])
   7,950,771,880 bytes allocated in the heap
      90,451,888 bytes copied during GC
       3,902,232 bytes maximum residency (5 sample(s))
         283,880 bytes maximum slop
               3 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0      7646 colls,  7646 par    1.404s   0.367s     0.0000s    0.0102s
  Gen  1         5 colls,     4 par    0.020s   0.004s     0.0008s    0.0017s

  Parallel GC work balance: 9.21% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.004s  (  0.001s elapsed)
  MUT     time    8.660s  (  8.635s elapsed)
  GC      time    1.424s  (  0.372s elapsed)
  EXIT    time    0.000s  (  0.003s elapsed)
  Total   time   10.088s  (  9.010s elapsed)

  Alloc rate    918,102,988 bytes per MUT second

  Productivity  85.8% of total user, 95.8% of total elapsed


real	0m9.112s
user	0m10.192s
sys	0m0.968s

Compilation finished at Sat Dec  7 15:27:36
* optimizing each speratesly (maxstep=20, nObs = 100, nsamp = 10)

(Diri [0.8554042870112029,1.8949733002679527],20,[20,20],[ND [4.95483813687416,0.183071741732003],ND [-4.97131170820822,0.12377586854471653]])
   5,243,973,400 bytes allocated in the heap
      92,364,904 bytes copied during GC
         224,840 bytes maximum residency (7 sample(s))
         199,696 bytes maximum slop
               0 MB total memory in use (0 MB lost due to fragmentation)

                                     Tot time (elapsed)  Avg pause  Max pause
  Gen  0      5056 colls,  5056 par    0.940s   0.328s     0.0001s    0.0184s
  Gen  1         7 colls,     6 par    0.008s   0.002s     0.0002s    0.0004s

  Parallel GC work balance: 0.61% (serial 0%, perfect 100%)

  TASKS: 10 (1 bound, 9 peak workers (9 total), using -N4)

  SPARKS: 0(0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.000s  (  0.001s elapsed)
  MUT     time    3.452s  (  3.377s elapsed)
  GC      time    0.948s  (  0.330s elapsed)
  EXIT    time    0.000s  (  0.003s elapsed)
  Total   time    4.400s  (  3.711s elapsed)

  Alloc rate    1,519,111,645 bytes per MUT second

  Productivity  78.5% of total user, 91.0% of total elapsed


real	0m3.838s
user	0m4.536s
sys	0m0.724s

Compilation finished at Sat Dec  7 15:34:56
